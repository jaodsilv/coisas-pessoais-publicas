\documentclass[twoside, conference, compsoc, onecolumn, 12pt,a4paper]{IEEEtran}

\usepackage{IEEEtsup} % Definições complementares e modificações.
\usepackage[latin1]{inputenc} % Disponibiliza acentos.
\usepackage[english,brazil]{babel}
\usepackage{latexsym,amsfonts,amssymb} % Disponibiliza fontes adicionais.
\usepackage{theorem} % Disponibiliza uma extensão do ambiente "Theorem".
\usepackage[cmex10]{amsmath} % Pacote matemático básico da AMS
\usepackage{url} % Melhora quebras de linha em endereços da Internet.

\ifCLASSINFOpdf
 \usepackage[pdftex]{graphicx}
  \DeclareGraphicsExtensions{.pdf,.png,.jpeg}
\else
 \usepackage[dvipdfm]{graphicx}
  \DeclareGraphicsExtensions{.eps}
\fi

\usepackage[tight,footnotesize]{subfigure} % Allows subfigures in figures.
\usepackage[noadjust]{cite} % Disponibiliza melhorias em citações.
\usepackage[all]{xy} % Pacote Xypic para desenhar diagramas.

\theoremstyle{plain}
\theorembodyfont{\itshape}
\newtheorem{thm}{Teorema}
\newtheorem{lem}{Lema}
\newtheorem{prp}{Proposição}
\newtheorem{cor}{Corolário}
\newtheorem{dfn}{Definição}
\theorembodyfont{\upshape}
\newtheorem{exm}{Exemplo}
\newtheorem{rmk}{Observação}
\renewcommand{\IEEEQED}{\IEEEQEDopen}

\hyphenation{}

\begin{document}

\urlstyle{tt}

\title{Teorema de Miler-Rabin\\Uma demonstração em Casos}

\author{%
 \IEEEauthorblockN{João Marco Maciel da Silva \,\IEEEauthorrefmark{1}}
 \IEEEauthorblockA{\IEEEauthorrefmark{1}%
                   Departamento de Ciência da Computação,
                   Instituto de Matemática e Estatística, \\
                   Universidade de São Paulo, São Paulo, Brasil,
                   CEP: 05508-090 \\
                   E-mail: jaodsilv@linux.ime.usp.br}
}

\maketitle

\selectlanguage{brazil}
\renewcommand{\IEEEkeywordsname}{Palavras chave}
\begin{abstract}
O Teorema de Miller-Rabin demonstrado pode ser dividido em subcasos a serem estudados visando diminuir a probabilidade de ser um pseudo-primo forte. Testes de primalidade determinísticos e probabilísticos têm muitas aplicações. [citacao] , o objetivo aqui é verificar que apenas pequenos casos .
\end{abstract}

\begin{IEEEkeywords}
Teorema de Miller-Rabin. Teste de Miller-Rabin. Teste de Miller. Segurança. teste de primalidade. chave pública.
\end{IEEEkeywords}

\selectlanguage{english}

\begin{abstract}
\end{abstract}
\renewcommand{\IEEEkeywordsname}{Index words}
\begin{IEEEkeywords}
\end{IEEEkeywords}

\selectlanguage{brazil}

\section{Introdução}

Antes de \cite{euclides:00}, os gregos de escolas anteriores, como a de Pitágoras, estavam interessados pelo estudo dos números primos pelas suas propriedades Numerológicas e Místicas.\\
Ainda antes de Euclides alguns teoremas sobre primos já haviam sido provadas, porém sem a formalidade que viria depois. \\
Após \cite{euclides:00}, os números primos começaram ser exaustivamente estudados, ele trás pela primeira vez um pouco de formalidade e também dois importantes resultados, o \textit{Teorema Fundamental da Aritmética} e que existem infinitos números primos. Com isso pode-se considerar o nascimento do estudo da Teoria dos Números.\\
Um dos tópicos da teoria dos números é a questo de como dizer, dado um nmero inteiro qualquer, se é primo ou composto de forma eficinte. O primeiro método  o crivo de Erastotenes, de 200A.C., muito mais adiante temos o \textit{teste determinstico de Miller}~\cite{miller1976riemann}, este, porém, utiliza a \textit{Hipótese Extendida de Riemann}, que ainda não foi provada. Poucos anos depois temos ~\cite{rabin1980probabilistic} onde ele mostra um novo teste de primalidade probabilístico baseado no ~\textit{teste de Miller}, este ficou conhecido como ~\textit{teste de Miller-Rabin}. Muitos outros fizeram trabalhos baseados nestes dois, entre \cite{bach:80}, \cite{dlp:93}, \cite{jaeschke:93}, \cite{agp:94}, \cite{zhatang:03}, \cite{schoof:04}, \cite{hurd}, \cite{macintosh:07}, \cite{jsozik:10} entre outros trabalhos interessantes.\\
O artigo está organizado da seguinte maneira: na seção 2 encontram-se definições e teoremas(sem a respectiva demonstração) pré-requisitos para a leitura seguinte com a apresentação do \textit{teste de Miller-Rabin} e a definição de \textit{pseudo-primo forte} ao final, na seção 3 e suas respectivas subseções encontra-se uma demonstração alternativa para o \textit{Teorema de Miller-Rabin}, nas subseções desta são explorados e discutidos os casos usados para demonstrar o teorema, a seção 5 conclui o artigo.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\section{Definições, teoremas e lemas anteriores}

esta seção dedica-se a apresentar as definições, teoremas e lemas necessários para o entendimento da seção seguinte, será presumido apenas conhecimentos básicos de operações matemáticas. Estes teoremas e lemas não serão demonstrados pois a demonstração pode ser encontrada na bibliografia recomendada.

%% divisibilidade
%% número primo e número composto
%% máximo divisor comum
%% mdc(m,n) <= m
%% congruências
%% TFA
\begin{thm}[Teorema Fundamental da Aritmética]~ \label{thm:TFA}
\end{thm}
%% aneis de inteiros
%% função phi de euler
%% numero de soluções de x^(n-1)\equiv 1 mod n
\begin{lem}[]~ \label{lem:soluc}
\end{lem}
%% teste de miller-rabin
\begin{dfn}[Teste de Miller-Rabin]~ \label{dfn:MRabin}
\end{dfn}
%%def pseudoprimo forte
\begin{dfn}[Pseudoprimo forte]~ \label{dfn:pseudo}
\end{dfn}
\begin{lem}[]~ \label{lem:Tj}
\end{lem}
\begin{IEEEproof}
\end{IEEEproof}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Teorema de Miller-Rabin}
Primeiramente, vamos enunciar o Teorema:
\begin{thm}[Teorema de Miller-Rabin]~ \label{thm:MRabin}
    Seja n um inteiro composto ímpar, então n passa no teste de miller-rabin no máximo para $\frac{n-1}{4}$ bases $b\in\mathbb{Z}_{n}$, isto é, se n é inteiro composto ímpar então ele é um pseudoprimo forte para no máximo $\frac{n-1}{4}$ bases naturais menores que $\vert{n}\vert$

\end{thm}

para pequenos casos é fácil testar computacionalmente, muitas implementações do teste podem ser encontradas na internet, como em %%%%%%%%%%%%%%%%%% incluir citação de página web.

Da mesma forma, %% citação do rabin %%
mostra números que chegam muito perto deste valor, o que não mostra ser a melhor probabilidade, mas muito perto disto, talvez perto o suficiente para que não possa ser melhorado.
A seguir temos não apenas uma demonstração mas também um estudo sobre cada um dos casos e em que casos este valor chega muito perto do valor $\frac{n-1}{4}$.
\begin{IEEEproof}

Seja $n\in\mathbb{Z}$ um inteiro composto ímpar. Então n pode ser escrito da forma $n = 1 + 2^S.t$, isto é, $n-1 = 2^S.t$, com S inteiro positivo e t ímpar.

Se n passa no \textit{Teste de Miller-Rabin}(\ref{dfn:MRabin}) na base b se
\begin{displaymath}
ou\ (i) b^t\equiv1\ mod\ n\\\ ou\ (ii) b^{2^\sigma t}\equiv-1\ mod\ n\ (0\leq\sigma\leq S-1).
\end{displaymath}

Se (1) então $b^t\equiv 1\ mod\ n$, das propriedades de congruências concluimos facilmente que $b^{2^St}=(b^t)^{2^S}\equiv(1)^{2^S}\equiv 1\ mod\ n$.

Se (2) então $b^{2^\sigma t}\equiv -1\ mod\ n$, das propriedades de conguências concluimos facilmente que $b^{2^St}=(b^{2^\sigma t})^{2^{S-\sigma}}\equiv(-1)^{2^{S-\sigma}}\equiv 1\ mod\ n$.

Disto podemos concluir que o número de bases para as quais n é pseudo-primo forte(\ref{dfn:pseudo}) é no máximo o número de soluções de $x^{n-1}\equiv 1\ mod\ n$. Da mesma maneira se $b^{2^St}\equiv 1\ mod\ n$ então ou $b^t\equiv 1\ mod\ n$ ou $b^{2^\sigma t}\equiv -1\ mod\ n,\ com\ (0\leq\sigma\leq S-1)$.
Isto significa que as bases b para as quais n passa no \textit{Teste de Miller-Rabin}(\ref{dfn:MRabin}) são todas as soluções de $x^{n-1}\equiv 1\ mod\ n$.

Pelo T.F.A.(\ref{thm:TFA}) n pode ser escrito de forma única $n=p_{1}^{e_{1}}p_{2}^{e_{2}}...p_{k}^{e_{k}}$

Já sabemos do Lema \ref{lem:soluc} que o número de soluções de $x^{n-1}\equiv 1\ mod\ n$ é dado por
\begin{displaymath}
\#Sols=\prod_{i=1}^k mdc((n-1), \phi(p_i^{e_{i}}))=\prod_{i=1}^k mdc(n-1, p_i^{e_i - 1}(p_i - 1))=\prod_{i=1}^k mdc(n-1, p_i - 1)
\end{displaymath}\\
\\
Agora basta buscar como se comporta este produtório, para facilitar esta busca foi dividido em vários subcasos, nestes são abertas discussões em cada sobre melhorar a probabilidade do teorema(\ref{thm:MRabin}). Os subcasos divididos são:

(1) existe algum j, tal que $e_j\geq 2$;

(2) $e_j=1,\ \forall j,\ tal\ que\ 1\leq j\leq k$ e $k>3$;

(3) $e_j=1,\ \forall j,\ tal\ que\ 1\leq j\leq k$ e $k=2$;

e (4) $e_j=1,\ \forall j,\ tal\ que\ 1\leq j\leq k$ e $k=3$. 

A escolha da ordem ficará clara com a demonstração.
Para cada bastando mostrar que $\#Sols\leq\frac{n-1}{4}$

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Caso 1}
Para o primeiro caso temos:
\begin{displaymath}
n=p_{1}^{e_{1}}p_{2}^{e_{2}}...p_{k}^{e_{k}},\ onde\ \exists j,\ tal\ que\ e_j\geq 2,\ com\ 1\leq j\leq k.
\end{displaymath}

Estimando o número de soluções da equação 
\begin{displaymath}
x^{n-1}\equiv 1\ mod\ n
\end{displaymath}

temos

\begin{displaymath}
\#Sols=\prod_{i=1}^k mdc(n-1, p_i - 1)\leq\prod_{i=1}^k {p_i -1}\leq\prod_{i=1}^k p_j(p_i -1),\ i\neq j.
\end{displaymath}

Como $\frac{p_j-1}{p_j^{e_j}}=\frac{p_j}{p_j^{e_j}}-\frac{1}{p_j^{e_j}}=\frac{1}{p_j^{e_j - 1}}-\frac{1}{p_j^{e_j}}=\frac{1}{p_j^{e_j-1}}(1-\frac{1}{p_j})$ e $e_j\geq 2$ então $\frac{p_j-1}{p_j^{e_j}}\leq\frac{1}{p_j}(1-\frac{1}{p_j})$.

Disto é concluído que $ p_j -1\leq\frac{1}{p_j}(1-\frac{1}{p_j})p_j^{e_j}$.

Podemos, assim, inferir que

\begin{displaymath}
\#Sols=\prod_{i=1}^k mdc(n-1, p_i - 1)\leq\prod_{i=1}^{k} p_i(\frac{1}{p_j}(1-\frac{1}{p_j}))p_j^{e_j}\leq\prod_{i=1}^{k} p_i^{e_i}(\frac{1}{p_j}(1-\frac{1}{p_j}))p_j^{e_j}=(\frac{1}{p_j}(1-\frac{1}{p_j}))n.
\end{displaymath}
Como $ \frac{1}{p_j}(1-\frac{1}{p_j})$ é decrescente podemos dizer que quanto maior o valor do menor primo tal que $e_j\geq 2$ menor será o valor de $\#Sols$ em relação a $n$.

Para $e_j=3$, que é o menor possível, já que n é composto ímpar, temos $ \frac{1}{p_j}(1-\frac{1}{p_j}) = \frac{1}{3}(1-\frac{1}{3})=\frac{2}{9}$. Como a divisibilidade por 3 é facilmente testável somando-se os algarismos, podemos inferir o menor $e_j=5$, resultando em $ \frac{1}{p_j}(1-\frac{1}{p_j}) = \frac{1}{5}(1-\frac{1}{5})=\frac{4}{25}\leq\frac{1}{6}$. Como a divisibiliade por 5 é facilmente testável olhando-se apenas o último algarismo, podemos inferir o menor $e_j=7$, resultando em $ \frac{1}{p_j}(1-\frac{1}{p_j}) = \frac{1}{7}(1-\frac{1}{7})=\frac{6}{49}\leq\frac{1}{8}$. Consecutivamente podendo ser melhorado com aumento de $p_j$.

Agora achando as soluções de $\frac{n-1}{4}\geq\frac{2n}{9}$ temos $n\geq 9$, que é o primeiro composto ímpar positivo. Para $\frac{n-1}{4}\geq\frac{n}{p_j}(1-\frac{1}{p_j})$ temos $n\geq\frac{p_j^2}{p_j^2 - 4p_j + 4}$ que é decrescente para $p_j>1$, o que satisfaz a condição.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\subsection{Casos 2 a 4}
Do segundo ao quarto caso temos:

\begin{displaymath}
n=p_{1}p_{2}...p_{k},\ onde\ k\geq2,
\end{displaymath}
ou seja, n é livre de quadrados e tem pelo menos 2 divisores distintos.

Assim, 
\begin{displaymath}
n-1=2^S.t,\ S\geq 1,\ t\ impar.
\end{displaymath}

\begin{displaymath}
p_j-1=2^{S_j}.t_j,\ S_j\geq 1,\ t_j\ impar.
\end{displaymath}

Se n passa no teste na base b, então
\begin{displaymath}
(1)b^t\equiv1\ mod\ n\ \ ou\ (2)b^{2^\sigma t}\equiv -1\ mod\ n,\ para\ certo\ 0<\sigma\leq S-1
\end{displaymath}
Se (1), então b é solução de $x^t\equiv 1\ mod\ n$.

Sabemos de %%lema
que $x^t\equiv 1\ mod\ n\leftrightarrow x^t\equiv 1\ mod\ p_j,\ \forall j$.

Disso tiramos que 
\begin{displaymath}
\#Sols=\prod_{j=1}^k mdc(t, p_j -1) = \prod_{j=1}^k mdc(t, 2^{S_j}t_j)=\prod_{j=1}^k mdc(t, t_j)=\prod_{j=1}^k T_j.
\end{displaymath}
\\\\
Caso contrário, se (2), b é solução de $x^{2^j t}\equiv -1\ mod\ n$. Então, pelo Lema (\ref{lem:sols}) e chamando o número de soluções de $x^{2^j t}\equiv -1\ mod\ e_i$ de $\#Sols_i$ temos:
\begin{displaymath}
\#Sols_i=2^j T_i,\ se\ 0\leq j\leq S_i - 1\
\
ou\
\
\#Sols_i=0,\ se\ j\geq S_i.
\end{displaymath}

Assim, pelo lema %%lema%%:
\begin{displaymath}
\#Sols = \prod_{i=1}^k \#Sols_i,\ com\ 0\leq i\leq S_i -1.
\end{displaymath}

Sem perda de generalidade, vamos assumir $S_1\leq S_2\leq ...\leq S_k$, então
\begin{displaymath}
\#Sols = \sum_{j=0}^{S_i - 1}(2^j T_1)(2^j T_2)...(2^j T_k)
\end{displaymath}

Assim, se n passa no teste na base b então b está entre as $T_1T_2...T_k +  \sum_{j=0}^{S_i - 1}(2^j T_1)(2^j T_2)...(2^j T_k)$ soluções. Colocando em evidência
\begin{displaymath}
\#Sols = T_1T_2...T_k(1 + \sum_{j=0}^{S_i - 1}(2^{jk})).
\end{displaymath}

Agora basta provar que $T_1T_2...T_k(1 + \sum_{j=0}^{S_i - 1}(2^{jk}))\leq\frac{\phi(n)}{4}\leq\frac{n-1}{4}$.


\subsubsection{Caso 2}
\subsubsection{Caso 3}
\subsubsection{Caso 4}

\end{IEEEproof}

\section{Conclusão}
\section{Agradecimentos}

Eu gostaria de agradecer ao meu orientador Paulo A. Martin por todo o incentivo neste projeto e na Iniciação Científica como um todo e ao meu colega Marcel H. Sobrinho que me ajudou nesta tarefa. %Gostaria de agradecer também ao IME por abrir o espaço para mostrarmos nosso trabalho.

\bibliographystyle{IEEEtran}

\bibliography{bibliografia}

\end{document}
